/**
 * selectKit - A jQuery plugin that makes select boxes look nicer.
 * @version v0.0.1
 * @link http://github.com/aslansky/selectkit
 * @license MIT
 */
!function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?t(require("jquery")):t(jQuery)}(function(t){"use strict";var e={langSingleDefaultText:"Select an Option",langMultiDefaultText:"Select Some Options",langNoSearchResultsText:"No results match",langMultiSelectedText:"%s and %d others selected"},s=function(){function t(){this.options_index=0,this.parsed=[]}return t.prototype.add_node=function(t){return"OPTGROUP"===t.nodeName.toUpperCase()?this.add_group(t):this.add_option(t)},t.prototype.add_group=function(t){var e,s,i,n,r,c;for(e=this.parsed.length,this.parsed.push({array_index:e,group:!0,label:this.escapeExpression(t.label),children:0,disabled:t.disabled}),r=t.childNodes,c=[],i=0,n=r.length;n>i;i++)s=r[i],c.push(this.add_option(s,e,t.disabled));return c},t.prototype.add_option=function(t,e,s){return"OPTION"===t.nodeName.toUpperCase()?(""!==t.text?(null!=e&&(this.parsed[e].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:t.value,text:t.text,html:t.innerHTML,selected:t.selected,disabled:s===!0?s:t.disabled,group_array_index:e,classes:t.className,style:t.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1):void 0},t.prototype.escapeExpression=function(t){var e,s;return null==t||t===!1?"":/[\&\<\>\"\'\`]/.test(t)?(e={"<":"&lt;",">":"&gt;",'""':"&quot;","'":"&#x27;","`":"&#x60;"},s=/&(?!\w+;)|[\<\>\"\'\`]/g,t.replace(s,function(t){return e[t]||"&amp;"})):t},t}();s.select_to_array=function(t){var e,i,n,r,c;for(i=new s,c=t.childNodes,n=0,r=c.length;r>n;n++)e=c[n],i.add_node(e);return i.parsed};var i=function(t,e){var s=this;i.isBrowserSupported()&&(this.clickTestAction=function(t){return i.testActive(t,s)},this.settings=e,this.$select=t,this.$container=null,this.$search=[],this.open=!1,this.settings.multi=!!this.$select.attr("multiple"),this.settings.disabled=!!this.$select.attr("disabled"),this.isDisabled=!1,this.settings.placeholder||(this.settings.placeholder=this.$select.attr("placeholder")||this.settings.multi?this.settings.langMultiSelectedText:this.settings.langSingleDefaultText),this.settings.reset&&!this.settings.resetText&&(this.settings.resetText="Any "+this.settings.placeholder),this.settings.searchplaceholder||(this.settings.searchplaceholder=""),this.settings.submit&&!this.settings.submitplaceholder&&(this.settings.submitplaceholder="Refresh"),this.render(),this.initEvents(),this.settings.disabled&&this.disable())};i.prototype.initEvents=function(){var e=this;this.$container.find(".selectkit-display").on("mousedown.selectkit",function(s){t(s.target).is(".selectkit-reset")||e.toggleDropdown(s)}),this.$container.find(".selectkit-refresh").on("mousedown.selectkit",function(t){e.toggleDropdown(t)}),this.$container.on("mouseup.selectkit",".selectkit-reset",function(){e.reset()}),this.$container.on("mousedown.selectkit",".selectkit-reset",function(t){t.stopPropagation()}),this.$list.on("mouseup.selectkit",".selectkit-choice",function(s){t(s.target).is(".selectkit-reset")||e.choiceMouseup(this)}),this.$search.length&&(this.$search.bind("keyup.selectkit",function(t){e.keydownCheck(t)}),this.$search.bind("keydown.selectkit",function(t){e.keydownCheck(t)}))},i.prototype.render=function(){var t=this.getSelectWidth();this.data=s.select_to_array(this.$select.get(0)),this.$select.hide(),this.$select.wrap('<div class="selectkit"></div>'),this.settings.cssClass&&this.settings.cssClass.length>0&&this.$select.parent().addClass(this.settings.cssClass),this.$container=this.$select.parent(),this.$container.css("width",t+"px"),this.$select.hasClass("error")&&this.$container.addClass("error"),this.$select.attr("id")&&this.$container.attr("id","sk-"+this.$select.attr("id")),this.$container.append('<div class="selectkit-display"><span>'+this.settings.placeholder+'</span><i class="selectkit-caret"></i></div>'),this.$display=this.$container.find(".selectkit-display"),this.$text=this.$display.find("span"),this.$container.append('<div class="selectkit-foldout"></div>'),this.$dropdown=this.$container.find(".selectkit-foldout"),this.data.length<=5&&(this.settings.search=!1),this.settings.search&&(this.$dropdown.append('<div class="selectkit-search"><input type="text" name="selectkit-search" placeholder="'+this.settings.searchplaceholder+'"></div>'),this.$search=this.$dropdown.find("input")),this.$dropdown.append('<div class="selectkit-list"></div>'),this.$dropdownList=this.$dropdown.find(".selectkit-list"),this.$dropdownList.append('<ul class="selectkit-choices"></ul>'),this.$list=this.$container.find(".selectkit-choices"),this.$choices=this.renderList(),this.settings.submit&&this.$dropdown.append('<div class="selectkit-submit"><a class="button selectkit-refresh"><span class="icon-close"></span>'+this.settings.submitplaceholder+"</a></div>"),this.setText()},i.prototype.renderList=function(){var e=this;return this.$list.empty(),t.each(this.data,function(){this.group?e.renderGroup(this):e.renderOption(this)}),this.$container.find(".selectkit-choice")},i.prototype.renderGroup=function(e){if(e.search_match!==!1){var s=t('<li class="selectkit-group" data-group-index="'+e.array_index+'">'+e.label+"</li>");s.data().data=e,this.$list.append(s)}},i.prototype.renderOption=function(e){if(e.empty){this.empty_choice=e;{this.getSelected()}return this.settings.reset&&!this.$list.find(".selectkit-reset").length&&this.$list.prepend('<li class="selectkit-choice selectkit-reset">'+this.settings.resetText+"</li>"),""}if(e.search_match===!1)return"";var s=e.search_text&&e.search_text.length>0?e.search_text:e.html,i=t('<li class="selectkit-choice">'+s+"</li>");return this.settings.multi&&this.settings.checkbox&&(i.prepend('<input type="checkbox" class="selectkit-check">'),i.addClass("selectkit-choice-checkbox")),e.disabled&&(i.find("input").prop("disabled",!0),i.addClass("selectkit-disabled")),e.selected&&(i.find("input").prop("checked",!0),i.addClass("selectkit-selected")),e.group_array_index&&(i.addClass("selectkit-group-item"),i.attr("data-group-index",e.group_array_index)),e.$ele=i,i.data().data=e,this.$list.append(i),i},i.prototype.toggleDropdown=function(t){t.stopPropagation(),this.isDisabled||(this.open?this.hide():this.show())},i.prototype.show=function(){var e=this;this.$dropdown.show(),this.open=!0,this.$container.addClass("selectkit-open"),this.$container.addClass("selectkit-active"),this.$search.length&&setTimeout(function(){e.$search.focus()},500),t(document).bind("click.selectkit",this.clickTestAction)},i.prototype.hide=function(){this.$dropdown.hide(),this.open=!1,this.$container.removeClass("selectkit-open"),this.$container.removeClass("selectkit-active"),t(document).unbind("click.selectkit",this.clickTestAction)},i.prototype.choiceMouseup=function(e){e=t(e).data().data,e.disabled||(this.settings.multi&&e.selected?this.deSelectChoice(e):this.selectChoice(e))},i.prototype.selectChoice=function(t){!this.settings.multi&&this.getSelected()&&this.deSelectChoice(this.getSelected()[0]),t.selected=!0,this.$select.find("option").get(t.options_index).selected=!0,this.renderList(),this.setText(),(this.settings.hideOnSelect||!this.settings.multi)&&this.hide(),this.$select.trigger("change")},i.prototype.deSelectChoice=function(t){this.getSelected().length;t.selected=!1,this.$select.find("option").get(t.options_index).selected=!1,this.renderList(),this.setText(),(this.settings.hideOnSelect||!this.settings.multi)&&this.hide(),this.settings.multi&&this.$select.trigger("change")},i.prototype.keydownCheck=function(t){var e,s;switch(e=null!=(s=t.which)?s:t.keyCode){case 13:case 38:case 40:case 9:case 16:case 91:case 17:t.preventDefault();break;default:return this.searchResults()}},i.prototype.setText=function(t){var e="";if(t)e=t;else{var s=this.getSelected();e=s&&1===s.length?s[0].html:s&&s.length>1?i.formatString(this.settings.langMultiSelectedText,s[0].html,s.length-1):this.settings.placeholder}return this.$text.html(e),e},i.prototype.getSelected=function(){var e=t.grep(this.data,function(t){return t.selected});return e.length?e:null},i.prototype.searchResults=function(){var t,e,s,i,n,r,c,o,h,a,l,d,p;for(this.clearNoResult(),n=0,c=this.getSearchText(),t=c.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),i=this.settings.searchContains?"":"^",s=new RegExp(i+t,"i"),a=new RegExp(t,"i"),p=this.data,l=0,d=p.length;d>l;l++)e=p[l],e.search_text=e.html||e.label,e.search_match=!1,r=null,this.includeOptionInResults(e)?(e.search_match=this.stringMatch(e.search_text,s),e.search_match?(n+=1,c.length&&(o=e.search_text.search(a),h=e.search_text.substr(0,o+c.length)+"</em>"+e.search_text.substr(o+c.length),e.search_text=h.substr(0,o)+"<em>"+h.substr(o)),e.search_match=!0):e.search_match=!1):e.search_match=!1;return 1>n&&c.length?this.setNoResult():(this.renderList(),void 0)},i.prototype.clearNoResult=function(){this.$list.find(".no-results").remove()},i.prototype.setNoResult=function(){return this.$list.empty(),this.$list.append('<li class="no-results">'+this.settings.langNoSearchResultsText+"</li>")},i.prototype.stringMatch=function(t,e){var s,i,n,r;if(e.test(t))return!0;if((t.indexOf(" ")>=0||0===t.indexOf("["))&&(i=t.replace(/\[|\]/g,"").split(" "),i.length))for(n=0,r=i.length;r>n;n++)if(s=i[n],e.test(s))return!0},i.prototype.includeOptionInResults=function(t){return t.disabled?!1:t.group?!0:t.empty?!1:!0},i.prototype.reset=function(){t.each(this.data,function(t,e){e.selected=void 0,e.search_match=void 0}),this.renderList(),this.setText(),this.settings.multi&&this.$select.find(":selected").each(function(){this.selected=!1}),this.$select.find("option").get(this.empty_choice.options_index).selected=!0,this.$select.change(),this.hide()},i.prototype.destroy=function(){this.$select.show(),this.$container.before(this.$select),this.$container.remove()},i.prototype.disable=function(){this.isDisabled=!0,this.$display.addClass("selectkit-disabled")},i.prototype.enable=function(){this.isDisabled=!1,this.$display.removeClass("selectkit-disabled")},i.prototype.getSelectWidth=function(){return null!=this.settings.width?this.settings.width:this.$select.get(0).offsetWidth},i.prototype.getSearchText=function(){return this.$search.val()===this.placeholder?"":t("<div/>").text(t.trim(this.$search.val())).html()},i.testActive=function(e,s){var i=t(e.target).closest(".selectkit");return i.length&&s.$container.get(0)===i.get(0)?!0:(s.hide(),!1)},i.isBrowserSupported=function(){return"Microsoft Internet Explorer"===window.navigator.appName?document.documentMode>=8:/iP(od|hone)/i.test(window.navigator.userAgent)?!1:/Android/i.test(window.navigator.userAgent)&&/Mobile/i.test(window.navigator.userAgent)?!1:!0},i.formatString=function(){var t,e,s;for(t=arguments[0],e=[],s=1;s<arguments.length;s++)e.push(arguments[s]);for(s in e)t=t.replace(/%[a-z]/,e[s]);return t},t.fn.selectKit=function(s){if(!i.isBrowserSupported())return this;var n=t.extend({},e,s);return this.each(function(){var e=t(this);void 0===s||t.isPlainObject(s)?e.data("selectkit",new i(e,t.extend({},n,e.data()))):e.data().selectkit&&e.data().selectkit[s].call(e.data().selectkit)})}});